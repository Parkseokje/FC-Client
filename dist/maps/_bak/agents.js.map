{"version":3,"sources":["_bak/agents.js"],"names":["requirejs","jQuery","required","balance","amount","min","sumDebit","Number","$","btn_create_agent_submit","frm_set_agent_password","create_agent_code","pass","re_pass","btn_dropdown_action","credit_to","frm_create_agent","layer","newBalance","currentBalance","agent_duplicated","code","parent_id","suspend","_this","on","this","attr","debit_to","bind","modal","find","val","submitHandler","f","confirm","validate","remote","url","async","rules","minlength","type","data","JSON","parse","console","log","json","success","duplicated","messages","equalTo","credit_amount","credit_balance","credit_sum_balance","frm_credit_to","submit_check","sumCredit","my_balance","sum_balance","memo","debit_amount","debit_sum_balance","frm_debit_to","range","debit_balance","target","set_suspend","checkSuspend","post","_code","done"],"mappings":"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","file":"../../javascripts/_bak/agents.js","sourcesContent":["'use strict';\nrequirejs(\n  [\n    'jquery'\n    , 'bootstrap'\n    , 'jquery_datatable'\n    , 'bootstrap_datatable'\n    , 'fastclick'\n    , 'jqueryValidate'\n  ],\n\n\n  function (jQuery) {\n    var $ = jQuery;\n\n    $('#table_agent').DataTable({\n      \"paging\": false,\n      \"lengthChange\": true,\n      \"searching\": false,\n      \"ordering\": true,\n      \"info\": true,\n      \"autoWidth\": true\n    });\n\n    var frm_create_agent = $('#frm_create_agent');\n    var btn_create_agent_submit = $('.btn-create-agent-submit');\n    var frm_set_agent_password = $('#frm_set_agent_password');\n    var create_agent_code = $('.create-agent-code');\n    var pass = $('.pass');\n    var re_pass = $('.re_pass');\n    var btn_dropdown_action = $('.btn-dropdown-action');\n    var credit_to = $('.credit-to');\n    var debit_to = $('.debit-to');\n    var my_balance = $('.my_balance');\n\n\n    var\n      code = null,\n      balance = null,\n      parent_id = null,\n      layer = null,\n      suspend = null,\n      newBalance = null,\n      currentBalance = null,\n      amount = null,\n      agent_duplicated = null;\n\n    /*dropdown action click시 데이터 바인딩*/\n    btn_dropdown_action.on('click', function () {\n      code = ($(this).attr('data-code'));\n      balance = Number($(this).attr('data-balance'));\n      parent_id = ($(this).attr('data-parent_id'));\n      layer = ($(this).attr('data-layer'));\n      suspend = ($(this).attr('data-suspend'));\n    });\n\n\n    /* credit modal show*/\n    credit_to.bind('click', function () {\n      var _this = $('#modal_credit_to');\n      _this.modal('show');\n      _this.find('#credit_target').val(code);\n      _this.find('#credit_balance').val(balance);\n    });\n\n    /*debit modal show*/\n    debit_to.bind('click', function () {\n      var _this = $('#modal_debit_to');\n      _this.modal('show');\n      _this.find('#debit_target').val(code);\n      _this.find('#debit_balance').val(balance);\n    });\n\n    /*password re set modal show*/\n    $('.set-agent-password').on('click', function () {\n      var _this = $('#setAgentPassword');\n      _this.modal('show');\n      _this.find('#code').val(code);\n    });\n\n    $('#select-agent-code').on('change', function () {\n      var layer = $(this).find('option:selected').attr('data-layer');\n      $('#agent-layer').val(layer);\n    });\n\n    frm_create_agent.validate({\n      //validation이 끝난 이후의 submit 직전 추가 작업할 부분\n      submitHandler: function () {\n        var f = confirm(\"작업을 완료하겠습니까?\");\n        if (f) {\n          return true;\n        } else {\n          return false;\n        }\n      },\n      //규칙\n      rules: {\n        create_agent_code: {\n          required: true,\n          minlength: 4,\n          remote: {\n            async: false,\n            url: '/api/v1/agent/duplicated',\n            type: 'post',\n            dataFilter: function (data) {\n              var json = JSON.parse(data);\n              console.log(json);\n              if (json.success && json.duplicated) {\n                return \"\\\"\" + '이미 사용중인 Agent code 입니다.' + \"\\\"\";\n              } else {\n                return true;\n              }\n            }\n          }\n\n        },\n        pass: {\n          required: true,\n          minlength: 4\n        },\n        re_pass: {\n          required: true,\n          minlength: 4,\n          equalTo: pass\n        }\n      },\n      //규칙체크 실패시 출력될 메시지\n      messages: {\n        create_agent_code: {\n          required: \"필수로입력하세요\",\n          minlength: \"최소 {0}글자이상이어야 합니다\"\n        },\n        pass: {\n          required: \"필수로입력하세요\",\n          minlength: \"최소 {0}글자이상이어야 합니다\"\n        },\n        re_pass: {\n          required: \"필수로입력하세요\",\n          minlength: \"최소 {0}글자이상이어야 합니다\",\n          equalTo: \"비밀번호가 일치하지 않습니다.\"\n        }\n      }\n    });\n\n    frm_set_agent_password.validate({\n      //validation이 끝난 이후의 submit 직전 추가 작업할 부분\n      submitHandler: function () {\n        var f = confirm(\"작업을 완료하겠습니까?\");\n        if (f) {\n          return true;\n        } else {\n          return false;\n        }\n      },\n      //규칙\n      rules: {\n        pass: {\n          required: true,\n          minlength: 4\n        },\n        re_pass: {\n          required: true,\n          minlength: 4,\n          equalTo: '#set_password'\n        }\n      },\n      //규칙체크 실패시 출력될 메시지\n      messages: {\n        pass: {\n          required: \"필수로입력하세요\",\n          minlength: \"최소 {0}글자이상이어야 합니다\"\n        },\n        re_pass: {\n          required: \"필수로입력하세요\",\n          minlength: \"최소 {0}글자이상이어야 합니다\",\n          equalTo: \"비밀번호가 일치하지 않습니다.\"\n        }\n      }\n    });\n\n\n    /*credit To Agent*/\n    var\n      credit_amount = $('#credit_amount'),\n      credit_balance = $('#credit_balance'),\n      credit_sum_balance = $('#credit_sum_balance'),\n      btn_credit_to_submit = $('.btn-credit-to-submit'),\n      frm_credit_to = $('#frm_credit_to');\n\n    credit_amount.bind('change', function () {\n      currentBalance = Number(credit_balance.val());\n      amount = Number(credit_amount.val());\n\n      newBalance = sumCredit(currentBalance, amount);\n      my_balance.val(sumDebit(Number($('#my_current_balance').val()), amount));\n      credit_sum_balance.val(newBalance);\n    });\n\n    function sumCredit(balance, amount) {\n      return (balance + amount);\n    }\n\n    frm_credit_to.validate({\n      submitHandler: function () {\n        var submit_check = confirm('입력하신 Amount : ' + amount + '$ 총합산 Balance : ' + newBalance + '$가 맞습니까?');\n        if (submit_check) {\n          return true\n        } else {\n          return false\n        }\n      },\n      rules: {\n        target: {\n          required: true\n        },\n        balance: {\n          required: true\n        },\n        sum_balance: {\n          required: true,\n          min: 1\n        },\n        amount: {\n          required: true,\n          range: [1, $('#my_current_balance').val()]\n        },\n        memo: {\n          required: true\n        }\n      }\n    });\n\n\n    /*credit To Agent END*/\n\n    /*Debit To Agent*/\n    var\n      debit_amount = $('#debit_amount'),\n      debit_balance = $('#debit_balance'),\n      debit_sum_balance = $('#debit_sum_balance'),\n      frm_debit_to = $('#frm_debit_to');\n\n\n    debit_amount.bind('change', function () {\n      currentBalance = Number(debit_balance.val());\n      amount = Number(debit_amount.val());\n\n      newBalance = sumDebit(currentBalance, amount);\n      my_balance.val(sumCredit(Number($('#my_current_balance').val()), amount));\n      debit_sum_balance.val(newBalance);\n    });\n\n\n    function sumDebit(balance, amount) {\n      return Number(balance - amount);\n    }\n\n    frm_debit_to.validate({\n      submitHandler: function () {\n        var submit_check = confirm('입력하신 Amount : ' + amount + '$ 총합산 Balance : ' + newBalance + '$가 맞습니까?');\n        if (submit_check) {\n          return true;\n        } else {\n          return false;\n        }\n      },\n      rules: {\n        target: {\n          required: true\n        },\n        sum_balance: {\n          required: true,\n          min: 0\n        },\n        balance: {\n          required: true\n        },\n        amount: {\n          required: true,\n          min: 1\n          // range: [1, 1670]\n        },\n        memo: {\n          required: true\n        }\n      }\n    });\n\n    /*Debit To Agent END*/\n\n    /*set suspend agent*/\n    var set_suspend = $('.set-suspend');\n\n    set_suspend.on('click', function () {\n      var checkSuspend = confirm(code + 'Agent를 정지 시키겠습니까?');\n      if (checkSuspend) {\n        var _code = code;\n        $.post('/api/v1/agent/to/suspend', {code: _code, suspend: 1}).done(function (data) {\n          console.log(data)\n        })\n      }\n    });\n\n    /*set wake up agent*/\n    var wake_up = $('.set-wake-up');\n\n    wake_up.on('click', function () {\n      var checkSuspend = confirm(code + 'Agent를 활성화 시키겠습니까?');\n      if (checkSuspend) {\n        var _code = code;\n        $.post('/api/v1/agent/to/suspend', {code: _code, suspend: 0}).done(function (data) {\n          console.log(data)\n        })\n      }\n    });\n  }\n);\n\n"]}