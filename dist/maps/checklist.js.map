{"version":3,"sources":["checklist.js"],"names":["window","requirejs","$btnPlay","url","sessionProgressStartLogger","data","training_user_id","course_id","course_list_id","trainingUserId","done","courseId","courseListId","res","success","console","error","msg","sessionProgressEndLogger","location","href","nextUrl","attr","$","$buttonGroup","$button","this","parent","hasClass","$groupButtons","prop","children","addClass","not","removeAttr","removeClass","on","e","preventDefault","$btnSumitAnswers","answers","invalidInputCount","each","index","itemId","itemType","inputIsValid","push","id","answer","val","str","find","map","type","click","alert"],"mappings":"AAAA,YAEAA,QAAOC,WAIL,UAEA,SAAIC,GAkCAC,QAAKC,KACLC,EAAAA,MACEC,KAAAA,OACAC,IAAAA,yBACAC,MAHIF,iBAAAG,EAKLC,UAAKC,EACNH,eAAkBI,KAEjBF,KAAA,SAAAG,GAXHA,EAAAC,SAaDC,QAAAC,MAAAH,EAAAI,OAMGd,QAAKe,KACLb,EAAAA,MACEC,KAAAA,OACAC,IAAAA,uBACAC,MAHIF,iBAAAG,EAKLC,UAAKC,EACNH,eAAkBI,KAAlBF,KAAA,SAEOG,GACLb,EAAOmB,QAGZnB,OAAAmB,SAAAC,KAAAC,EAFIN,QAAAC,MAAAH,EAAAI,OA7DL,GAAIR,GAAAA,GAAAA,OAAAA,EACAE,EAAWT,EAASG,uBACpBO,EAAAA,EAAAA,kBACAS,EAAUnB,EAAcG,KAA5B,oBAFIM,EAAWT,EAASG,KAAK,aAI7BO,EAAAV,EAAAG,KAAA,kBAFIgB,EAAUnB,EAASoB,KAAK,OAK5BC,GAAE,WAIAnB,MAGAmB,EAAA,qBAAoBC,MAAAA,WAFpB,GAAIC,GAAUF,EAAEG,MAAMC,SAIlBF,EAAQG,EAASD,SACjBE,EAAFL,EAA8BM,WAAKC,SAAnCR,EAAA,qBADFE,GAGOG,SAAA,WACLH,EAAAA,MAAQO,WAAS,WAAAF,KAAjB,WAAA,GACAP,EAAQD,YAAK,kBAEXO,EAAAA,SAAcI,gBACfV,EAAAG,MAAAJ,KAAA,UAAA,WAAAQ,KAAA,WAAA,GACF,WAAAN,EAAAnB,KAAA,SAdHwB,EAAAI,IAAAV,EAAAG,OAAAQ,WAAA,WAAAJ,KAAA,WAAA,GAAAH,SAAAQ,YAAA,mBAyDCjC,EAHDkC,GAAA,QAAA,SAAAC,GACEA,EAAEC,iBAIJC,MAGEA,EAAcH,GAAd,QAAA,SAAAC,GACAA,EAAAC,gBAEAf,IAAEiB,MACAC,EAAqBpC,CAErBkB,GAAA,mBAAmBmB,KAAnB,SAAAC,GAFA,GAAIC,GAASrB,EAAEG,MAAMrB,KAAK,MAI1BwC,EAAQA,EAARnB,MAAArB,KAAA,QACAyC,GAAA,CAEIA,QAAAA,GACD,IAAA,QACY,KAAbN,EAAAA,MAAQO,QACNC,GADW,GAAAR,EAAbO,MAIAC,GAAAJ,EAFEK,OAAQ1B,EAAEG,MAAMwB,OAKlB,MAEC,SAFD,GAAIC,GAAM5B,EAAEG,MAAM0B,KAAK,iBAAiBC,IAAI,WAI5C,MAAIF,GAAAA,MAAJD,QACEJ,MAAAA,KAAAA,IADU,MAARK,IAIJX,GAAa,GAAAA,EAAbO,MAIAC,GAAAJ,EAxBFK,OAAAE,IA8BIL,GAnCNvB,EAAA,kBAAAqB,EAAA,KAAAT,YAAA,gBAsCIZ,EAAE,kBAAoBqB,EAAS,KAAKZ,SAAS,mBAN/CS,IAKElB,EAAE,kBAAoBqB,EAAS,KAAKT,YAAY,iBAChDZ,EAAE,kBAAoBqB,EAAS,KAAKZ,SAAS,mBAMxC,IACLsB,EAEAjD,EAAAA,MACEmC,KAAAA,OACAlC,IAAAA,oBACAC,MACAC,QAAAA,EACAF,iBAAAG,EALIF,UAAAI,EAQPD,eAAeG,KAIZb,KAAAA,SAAAa,GACAA,EAAAC,SAGAZ,OAAAA,MAASqD,oBAnBbhB,EAAAP,SAAA,SAFF9B,EAwBOiC,YAAA,SACLnC,EAAauD,SANThB,QAAAA,MAAAA,EAAiBP,OAMrBhC,OAAOwD,MAAM","file":"../javascripts/checklist.js","sourcesContent":["'use strict';\n\nwindow.requirejs([\n  'common'\n],\nfunction (Util) {\n  var $ = $ || window.$;\n  var $btnSumitAnswers = $('#btn_submit_answers'); // 제출하기 버튼\n  var $btnPlay = $('#btn_play_next');\n  var trainingUserId = $btnPlay.data('training-user-id');\n  var courseId = $btnPlay.data('course-id');\n  var courseListId = $btnPlay.data('course-list-id');\n  var nextUrl = $btnPlay.attr('href');\n\n  // var checklistGroupId = $btnPlay.data('checklist-group-id');\n\n  // jquery load event\n  $(function () {\n    sessionProgressStartLogger();\n  });\n\n  $('[name*=\"sample-\"]').click(function () {\n    var $button = $(this).parent();\n    var $buttonGroup = $button.parent();\n    var $groupButtons = $buttonGroup.children().children($('[name*=\"sample-\"]'));\n\n    if ($button.hasClass('active')) {\n      $(this).removeAttr('checked').prop('checked', false);\n      $button.removeClass('active focus');\n    } else {\n      $button.addClass('active focus');\n      $(this).attr('checked', 'checked').prop('checked', true);\n      if ($buttonGroup.data('type') !== 'choose') {\n        $groupButtons.not($(this)).removeAttr('checked').prop('checked', false).parent().removeClass('active focus');\n      }\n    }\n  });\n\n  // 세션 시작일시 로깅\n  function sessionProgressStartLogger () {\n    $.ajax({\n      type: 'POST',\n      url: '/session/log/starttime',\n      data: {\n        training_user_id: trainingUserId,\n        course_id: courseId,\n        course_list_id: courseListId\n      }\n    }).done(function (res) {\n      if (!res.success) {\n        console.error(res.msg);\n      }\n    });\n  }\n\n      // 세션 종료일시 로깅\n  function sessionProgressEndLogger () {\n    $.ajax({\n      type: 'POST',\n      url: '/session/log/endtime',\n      data: {\n        training_user_id: trainingUserId,\n        course_id: courseId,\n        course_list_id: courseListId\n      }\n    }).done(function (res) {\n      if (!res.success) {\n        console.error(res.msg);\n      } else {\n        window.location.href = nextUrl;\n      }\n    });\n  }\n\n  // 세션 종료로그를 기록한다.\n  $btnPlay.on('click', function (e) {\n    e.preventDefault();\n    sessionProgressEndLogger();\n  });\n\n  $btnSumitAnswers.on('click', function (e) {\n    e.preventDefault();\n\n    var answers = [];\n    var invalidInputCount = 0;\n\n    $('.checklist-item').each(function (index) {\n      var itemId = $(this).data('id');\n      var itemType = $(this).data('type');\n      var inputIsValid = true;\n\n      switch (itemType) {\n      case 'write':\n        if ($(this).val() === '') {\n          inputIsValid = false;\n        }\n        answers.push({\n          id: itemId,\n          answer: $(this).val()\n        });\n        break;\n\n      default:\n        var str = $(this).find('input:checked').map(function () {\n          return $(this).val();\n        }).get().join(';');\n\n        if (str === '') {\n          inputIsValid = false;\n        }\n\n        answers.push({\n          id: itemId,\n          answer: str\n        });\n        break;\n      }\n\n      if (!inputIsValid) {\n        invalidInputCount++;\n        $('.alert[data-id=' + itemId + ']').removeClass('alert-success');\n        $('.alert[data-id=' + itemId + ']').addClass('alert-danger');\n      } else {\n        $('.alert[data-id=' + itemId + ']').removeClass('alert-danger');\n        $('.alert[data-id=' + itemId + ']').addClass('alert-success');\n      }\n    });\n\n    if (invalidInputCount === 0) {\n      // 자료 저장\n      $.ajax({\n        type: 'POST',\n        url: '/checklist/submit',\n        data: {\n          answers: answers,\n          training_user_id: trainingUserId,\n          course_id: courseId,\n          course_list_id: courseListId\n          // checklist_group_id: checklistGroupId\n        }\n      })\n      .done(function (res) {\n        if (!res.success) {\n          console.error(res.msg);\n        } else {\n          window.alert('성실히 답변해주셔서 감사합니다');\n          // 정답체크 완료 시 정답확인: 비활성화, 다음 버튼: 활성화\n          $btnSumitAnswers.addClass('blind');\n          $btnPlay.removeClass('blind');\n          $btnPlay.click();\n        }\n      });\n    } else {\n      window.alert('작성하지 않은 항목이 존재합니다');\n    }\n  });\n});\n"]}