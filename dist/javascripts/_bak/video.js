"use strict";requirejs(["jquery","axios","plyr","jqueryTimer"],function(e,t,n){function i(){e.get("/video/settings",function(t){g=t.interval,y=e.timer(1e3*g,r,!0),y.stop(),h=t.waiting_seconds})}function o(){return t.delete("/video/log",{params:{video_id:L}}).then(function(e){}).catch(function(e){console.log(e)})}function s(){return t.delete("/session/log",{params:{training_user_id:P,course_list_id:q}}).then(function(e){}).catch(function(e){console.log(e)})}function a(){h-=1,D.html(" ( "+h+" 초 이내 클릭 )"),0===h&&(v.stop(),alert("비디오를 재시청 해주시기 바랍니다."),t.all([o(),s()]).then(t.spread(function(e,t){location.reload()})))}function r(){m+=g,e.ajax({type:"POST",url:"/video/log/playtime",data:{training_user_id:P,video_id:L,timer_played_seconds:m,video_duration:C}}).done(function(e){e.success?(m=0,T=e.total_played_seconds,p(T)):(console.error(e.msg),y.stop(),E.plyr.stop())})}function d(){e.ajax({type:"POST",url:"/session/log/starttime",data:{training_user_id:P,course_id:S,course_list_id:q}}).done(function(e){e.success?M=e.hasEnded:(y.stop(),E.plyr.stop())})}function u(){e.ajax({type:"POST",url:"/session/log/endtime",data:{training_user_id:P,course_id:S,course_list_id:q}}).done(function(e){e.success?location.href=O:(console.error(e.msg),y.stop(),E.plyr.stop())})}function c(){e.ajax({type:"POST",url:"/video/log/endtime",data:{video_id:L}}).done(function(e){e.success||console.error(e.msg)})}function l(e){C=E.plyr.getDuration(),p(T)}function p(e){Math.floor(.8*C)<=e&&x.removeClass("blind")}function f(){var e=_(w);w.css("margin-top","-"+e/2+"px"),b.css("height",e+"px"),w.removeClass("blind")}function _(e){return Math.floor(e.height())}var g=0,y=null,v=null,m=0,h=0,j={autoplay:!1,debug:!1},x=(n.setup(e(".js-player"),j),e(".btn_play")),E=e(".plyr__video-wrapper")[0],b=e(".video_section"),w=e(".tmp_video"),L=w.data("id"),T=w.data("total-play"),O=x.parent().attr("href"),P=x.data("training-user-id"),S=x.data("course-id"),q=x.data("course-list-id"),C=null,D=e(".wait-message"),M=!1;e(function(){i()}),E.addEventListener("ready",function(e){y.stop(),f(),l(e.type)}),E.addEventListener("play",function(e){d(),l(e.type),y.reset(1e3*g)}),E.addEventListener("pause",function(){y.pause(),c()}),E.addEventListener("timeupdate",function(){}),E.addEventListener("ended",function(){y.stop(),p(T+g),c(),M||(v=e.timer(1e3,a,!0))}),e(window).bind("resize",function(){f()}),x.on("click",function(e){e.preventDefault(),u()})});
//# sourceMappingURL=../../maps/_bak/video.js.map
